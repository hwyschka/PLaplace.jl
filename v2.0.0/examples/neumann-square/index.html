<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A Neumann Problem · PLaplace.jl</title><meta name="title" content="A Neumann Problem · PLaplace.jl"/><meta property="og:title" content="A Neumann Problem · PLaplace.jl"/><meta property="twitter:title" content="A Neumann Problem · PLaplace.jl"/><meta name="description" content="Documentation for PLaplace.jl."/><meta property="og:description" content="Documentation for PLaplace.jl."/><meta property="twitter:description" content="Documentation for PLaplace.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PLaplace.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PLaplace.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../algorithm/">Algorithm</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../dirichlet-square/">A Dirichlet Problem</a></li><li class="is-active"><a class="tocitem" href>A Neumann Problem</a></li><li><a class="tocitem" href="../vector-neumann-cube/">A Vector-Valued Problem</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/internal/">Internal</a></li></ul></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>A Neumann Problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A Neumann Problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hwyschka/PLaplace.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hwyschka/PLaplace.jl/blob/master/docs/src/examples/neumann-square.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-Neumann-Problem"><a class="docs-heading-anchor" href="#A-Neumann-Problem">A Neumann Problem</a><a id="A-Neumann-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#A-Neumann-Problem" title="Permalink"></a></h1><p>Let&#39;s go through a code for the <em>p</em>-Laplace equation on a unit square</p><p class="math-container">\[\Omega = (0,1)^2\]</p><p>and a part of the boundary</p><p class="math-container">\[\Gamma = (\{0\} \times [0,1]) \cup ([0,1] \times \{1\})\]</p><p>with mixed homogeneous Dirichlet and inhomogeneous Neumann boundary conditions given by</p><p class="math-container">\[\begin{aligned}
-\Delta_p v = 0 &amp;\quad \text{in}\; \Omega,\\
\Vert \nabla v \Vert_2^{p-2} \frac{\partial v}{\partial \eta}  
    = x_2^2 - x_1^2 &amp;\quad \text{on}\; \Gamma,\\
v = 0 &amp;\quad \text{on}\; \partial\Omega\setminus\Gamma.
\end{aligned}\]</p><p>The code is quite similar to the <a href="../dirichlet-square/#A-Dirichlet-Problem">Dirichlet Problem</a>, so here, we will mainly focus on the few differences.</p><p>Includes and file creation are identical</p><pre><code class="language-julia hljs">using PLaplace

output_path::String = &quot;results/neumann-square/&quot;
mkpath(output_path)

statistics_file = output_path * &quot;statistics.txt&quot;
write_statistics_header(statistics_file, guarded = true)</code></pre><p>For the mesh with boundary conditions, we will now select two different sets of physical boundaries. One for the Dirichlet part and one for the Neumann part.</p><pre><code class="language-julia hljs">mesh = import_mesh(&quot;../meshes/square.msh&quot;)

dirichlet_boundary = select_boundaries(mesh, 1001, 1004)
neumann_boundary = select_boundaries(mesh, 1002, 1003)</code></pre><p>Here, in particular, the IDs 1001 and 1004 denote the bottom and the right boundary of the square, respectively. 1002 and 1003 are the remaining top and left boundaries. Note that the two boundary sets shall be distinct. If a node is in the Dirichlet boundary, it will be fixed within the algorithm, and the Neumann condition is ignored. For any mesh, you get the physical boundary ideas from the mesh file. The whole procedure of boundary selection is only possible if the boundaries were specified as physical elements in gmsh during the creation of the mesh.</p><p>The boundary conditions themselves can again be specified analytically using</p><pre><code class="language-julia hljs">h(x) = x[2]^2 - x[1]^2
g(x) = 0</code></pre><p>For actually using the Neumann condition in the algorithm,  the condition itself and the boundary where it shall be applied  have to be provided via keyword arguments.</p><pre><code class="language-julia hljs">data = solve_plaplace(
    p,
    mesh,
    g,
    dirichlet_boundary,
    h = h,
    neumann_boundary = neumann_boundary
)</code></pre><p>Note that here, the identifier left of the assignment is the name of the keyword, which is specified in the api. To see a full list of keywords, see the documentation in the <a href="../../lib/public/#PLaplace.solve_plaplace">library</a>. The identifier on the right is the local name of the variable we created and only the same by (intended) coincidence.</p><p>Writing output files is no different from the Dirichlet example and is performed with</p><pre><code class="language-julia hljs">write_statistics(statistics_file, data)

write_result_to_vtk(output_path * &quot;result_p=$p&quot;, data)</code></pre><div class="admonition is-info"><header class="admonition-header">Visualization</header><div class="admonition-body"><p>The output files can again be used for external post-processing.<br/>Selected visualized results for comparison are given here.</p><table><tr><th style="text-align: center"><img src="../../assets/examples/neumann-square.png" alt="Result"/></th></tr><tr><td style="text-align: center"><em>Solution of the problem for various p = 2, 3, 5, 8, 15, 25 (left to right).</em></td></tr></table></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dirichlet-square/">« A Dirichlet Problem</a><a class="docs-footer-nextpage" href="../vector-neumann-cube/">A Vector-Valued Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 20 October 2024 11:11">Sunday 20 October 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
